# cell-seg-explainer

An GNN explainer on Synthetic dataset over cell segmentation data.

## Usage

```python
python explain.py -m gcn -n 1
```

* `-m` / `--model`: Name of the GNN model.
* `-n` / `–node`: Node index to explain.

## Example

Run `python explain.py` by default:

```bash
The loss on test dataset is: 1.0451111793518066 obtained in epoch 639
Explain node 1: 100%|██████████| 639/639 [00:01<00:00, 565.70it/s]
Node:  1 ; Label: 1.0
Related nodes: [1, 3, 7, 30, 36, 41, 46, 53, 55, 78, 93, 97, 102, 105, 112, 115, 149, 180, 183, 185, 195, 224, 242, 255, 259, 275, 281, 295, 298]
Related edges: [(1, 1), (1, 7), (1, 53), (1, 55), (1, 97), (1, 102), (1, 112), (1, 115), (1, 185), (1, 224), (1, 275), (1, 298), (3, 3), (3, 7), (3, 41), (3, 93), (3, 105), (3, 149), (3, 195), (3, 242), (7, 1), (7, 3), (7, 7), (7, 41), (7, 53), (7, 55), (7, 93), (7, 102), (7, 105), (7, 112), (7, 115), (7, 149), (7, 185), (7, 195), (7, 242), (7, 255), (7, 275), (30, 30), (30, 102), (30, 255), (30, 259), (30, 281), (36, 36), (36, 97), (36, 180), (36, 183), (36, 224), (36, 259), (41, 3), (41, 7), (41, 41), (41, 53), (41, 55), (41, 93), (41, 102), (41, 105), (41, 115), (41, 149), (41, 185), (41, 195), (41, 242), (41, 255), (46, 46), (46, 78), (46, 275), (46, 298), (53, 1), (53, 7), (53, 41), (53, 53), (53, 55), (53, 78), (53, 102), (53, 112), (53, 115), (53, 185), (53, 195), (53, 275), (53, 298), (55, 1), (55, 7), (55, 41), (55, 53), (55, 55), (55, 78), (55, 93), (55, 102), (55, 112), (55, 115), (55, 185), (55, 195), (55, 275), (55, 298), (78, 46), (78, 53), (78, 55), (78, 78), (78, 275), (78, 298), (93, 3), (93, 7), (93, 41), (93, 55), (93, 93), (93, 105), (93, 149), (93, 185), (93, 195), (93, 242), (93, 255), (97, 1), (97, 36), (97, 97), (97, 112), (97, 115), (97, 180), (97, 183), (97, 224), (97, 259), (102, 1), (102, 7), (102, 30), (102, 41), (102, 53), (102, 55), (102, 102), (102, 112), (102, 115), (102, 149), (102, 185), (102, 224), (102, 242), (102, 255), (102, 259), (102, 281), (105, 3), (105, 7), (105, 41), (105, 93), (105, 105), (105, 149), (105, 195), (105, 242), (105, 255), (112, 1), (112, 7), (112, 53), (112, 55), (112, 97), (112, 102), (112, 112), (112, 115), (112, 185), (112, 224), (112, 275), (112, 298), (115, 1), (115, 7), (115, 41), (115, 53), (115, 55), (115, 97), (115, 102), (115, 112), (115, 115), (115, 185), (115, 224), (115, 255), (115, 259), (149, 3), (149, 7), (149, 41), (149, 93), (149, 102), (149, 105), (149, 149), (149, 185), (149, 195), (149, 242), (149, 255), (180, 36), (180, 97), (180, 180), (180, 183), (180, 224), (183, 36), (183, 97), (183, 180), (183, 183), (183, 224), (185, 1), (185, 7), (185, 41), (185, 53), (185, 55), (185, 93), (185, 102), (185, 112), (185, 115), (185, 149), (185, 185), (185, 195), (185, 224), (185, 242), (185, 255), (185, 259), (195, 3), (195, 7), (195, 41), (195, 53), (195, 55), (195, 93), (195, 105), (195, 149), (195, 185), (195, 195), (195, 242), (224, 1), (224, 36), (224, 97), (224, 102), (224, 112), (224, 115), (224, 180), (224, 183), (224, 185), (224, 224), (224, 259), (242, 3), (242, 7), (242, 41), (242, 93), (242, 102), (242, 105), (242, 149), (242, 185), (242, 195), (242, 242), (242, 255), (255, 7), (255, 30), (255, 41), (255, 93), (255, 102), (255, 105), (255, 115), (255, 149), (255, 185), (255, 242), (255, 255), (255, 259), (255, 281), (259, 30), (259, 36), (259, 97), (259, 102), (259, 115), (259, 185), (259, 224), (259, 255), (259, 259), (259, 281), (275, 1), (275, 7), (275, 46), (275, 53), (275, 55), (275, 78), (275, 112), (275, 275), (275, 298), (281, 30), (281, 102), (281, 255), (281, 259), (281, 281), (295, 295), (295, 298), (298, 1), (298, 46), (298, 53), (298, 55), (298, 78), (298, 112), (298, 275), (298, 295), (298, 298)]
Marker importance: tensor([0.0285, 0.0278, 0.0271, 0.0307, 0.0293, 0.0278, 0.0243])
Node: 1 ; Label: 1.0 ; Marker: tensor([2.1443, 0.9518, 3.4839, 4.5587, 5.3697, 4.5624, 2.1292])
Node: 3 ; Label: -1.0 ; Marker: tensor([3.0583, 4.6319, 2.5982, 2.8001, 3.0074, 3.2757, 1.2368])
Node: 7 ; Label: -1.0 ; Marker: tensor([4.0506, 3.4598, 2.7937, 3.0212, 3.4287, 0.6920, 3.3271])
Node: 30 ; Label: 1.0 ; Marker: tensor([2.6874, 3.1012, 1.8882, 1.8134, 4.6235, 4.1564, 3.8890])
Node: 36 ; Label: 1.0 ; Marker: tensor([3.1494, 3.5821, 3.8299, 3.8278, 3.5467, 2.5226, 3.6641])
Node: 41 ; Label: 1.0 ; Marker: tensor([4.4309, 4.6884, 3.2373, 0.5018, 3.3844, 1.6893, 2.4993])
Node: 46 ; Label: -1.0 ; Marker: tensor([2.3995, 2.3514, 2.2747, 4.9844, 2.4178, 3.3268, 1.8396])
Node: 53 ; Label: -1.0 ; Marker: tensor([3.2390, 2.1107, 3.1213, 1.4630, 3.5039, 4.3197, 3.9140])
Node: 55 ; Label: 1.0 ; Marker: tensor([2.7572, 2.0972, 3.5815, 3.8575, 3.1379, 3.1861, 2.8119])
Node: 78 ; Label: -1.0 ; Marker: tensor([2.3767, 2.4796, 1.8877, 3.7311, 1.9371, 2.7454, 1.8310])
Node: 93 ; Label: 1.0 ; Marker: tensor([0.7374, 2.5803, 1.7739, 2.9615, 2.5173, 3.2090, 1.2356])
Node: 97 ; Label: 1.0 ; Marker: tensor([4.7024, 2.6279, 3.0843, 2.5469, 2.2590, 3.1361, 4.0729])
Node: 102 ; Label: -1.0 ; Marker: tensor([4.6043, 2.7335, 1.5417, 3.9514, 4.8359, 3.1873, 3.8395])
Node: 105 ; Label: 1.0 ; Marker: tensor([4.9990, 3.7640, 4.6873, 1.6920, 4.4724, 3.0749, 1.2131])
Node: 112 ; Label: 1.0 ; Marker: tensor([3.5134, 3.8645, 3.3315, 1.9582, 3.4334, 2.7700, 2.3649])
Node: 115 ; Label: 1.0 ; Marker: tensor([3.3187, 2.5617, 2.9792, 2.2127, 3.2469, 2.5417, 1.4473])
Node: 149 ; Label: 1.0 ; Marker: tensor([3.2988, 3.7671, 1.3067, 4.6389, 1.9550, 2.6649, 3.3807])
Node: 180 ; Label: 1.0 ; Marker: tensor([2.0124, 3.6594, 2.7570, 2.4787, 4.5941, 3.2978, 1.1806])
Node: 183 ; Label: 1.0 ; Marker: tensor([1.2217, 1.6995, 3.5012, 2.5247, 2.6934, 2.9741, 1.0458])
Node: 185 ; Label: 1.0 ; Marker: tensor([1.5658, 3.1115, 1.7288, 3.0664, 3.5406, 1.6811, 3.8454])
Node: 195 ; Label: -1.0 ; Marker: tensor([1.7663, 3.7167, 2.8082, 3.2771, 4.2279, 1.9088, 2.2636])
Node: 224 ; Label: -1.0 ; Marker: tensor([1.7577, 3.5173, 3.3208, 4.9186, 3.7423, 1.8687, 2.2071])
Node: 242 ; Label: 1.0 ; Marker: tensor([2.1613, 1.7909, 1.4342, 2.7921, 3.8328, 3.6168, 3.6763])
Node: 255 ; Label: -1.0 ; Marker: tensor([4.0364, 4.1643, 2.5274, 1.3665, 3.1834, 2.3311, 3.8223])
Node: 259 ; Label: 1.0 ; Marker: tensor([4.9865, 3.0073, 4.7080, 1.9952, 3.7548, 3.0113, 4.6910])
Node: 275 ; Label: 1.0 ; Marker: tensor([2.6518, 3.6686, 2.7124, 3.6848, 4.1775, 3.1651, 3.2331])
Node: 281 ; Label: -1.0 ; Marker: tensor([4.5773, 3.7625, 3.1465, 4.4876, 3.8397, 1.7437, 4.2366])
Node: 295 ; Label: 1.0 ; Marker: tensor([2.2698, 1.4409, 2.3298, 2.2073, 4.1306, 0.2609, 3.5103])
Node: 298 ; Label: -1.0 ; Marker: tensor([2.5129, 3.0696, 2.7995, 3.7030, 4.0515, 2.6339, 0.1279])
```

The visualization is automatic:

![Sample Visualization](https://github.com/Mars-tin/cell-seg-explainer/blob/master/plot/sample.png)



